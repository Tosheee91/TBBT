<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Big Bang Theory: Text Adventure</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f0f0f0;
            color: #333;
        }
        #game-container {
            background-color: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        #dialogue-box {
            height: 300px;
            overflow-y: auto;
            margin-bottom: 20px;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            background-color: #fafafa;
        }
        .character {
            font-weight: bold;
            margin-bottom: 5px;
        }
        .sheldon {
            color: #2b7bb9;
        }
        .leonard {
            color: #d35400;
        }
        .penny {
            color: #c0392b;
        }
        .howard {
            color: #16a085;
        }
        .raj {
            color: #8e44ad;
        }
        .player {
            color: #27ae60;
        }
        #options-container {
            display: grid;
            grid-template-columns: 1fr;
            gap: 10px;
        }
        button {
            padding: 10px;
            border: none;
            border-radius: 5px;
            background-color: #3498db;
            color: white;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        button:hover {
            background-color: #2980b9;
        }
        #stats {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
            padding: 10px;
            background-color: #eee;
            border-radius: 5px;
            flex-wrap: wrap;
        }
        .stat {
            text-align: center;
            margin: 5px;
        }
        #inventory {
            margin-top: 20px;
            padding: 10px;
            background-color: #eee;
            border-radius: 5px;
        }
        h1 {
            color: #2c3e50;
            text-align: center;
        }
        .ending {
            color: #e74c3c;
            font-weight: bold;
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <div id="game-container">
        <h1>The Big Bang Theory: Text Adventure</h1>
        
        <div id="stats">
            <div class="stat">День: <span id="day">1</span></div>
            <div class="stat">Шелдон: <span id="sheldon-score">50</span></div>
            <div class="stat">Леонард: <span id="leonard-score">50</span></div>
            <div class="stat">Пенни: <span id="penny-score">50</span></div>
            <div class="stat">Говард: <span id="howard-score">50</span></div>
            <div class="stat">Раджеш: <span id="raj-score">50</span></div>
        </div>
        
        <div id="dialogue-box"></div>
        
        <div id="options-container"></div>
        
        <div id="inventory">
            <h3>Инвентарь:</h3>
            <ul id="inventory-list">
                <li>Ключи от квартиры</li>
                <li>Телефон</li>
            </ul>
        </div>
    </div>

    <script>
        // Игровые переменные
        let gameState = {
            day: 1,
            scores: {
                sheldon: 50,
                leonard: 50,
                penny: 50,
                howard: 50,
                raj: 50
            },
            inventory: ["Ключи от квартиры", "Телефон"],
            flags: {
                metCharacters: false,
                knowsAboutSpot: false,
                coffeeOffered: false,
                comicBookStore: false,
                sheldonsRules: false,
                metPenny: false
            },
            currentScene: "start"
        };

        // Все сцены игры
        const scenes = {
            start: {
                text: "Вы только что переехали в квартиру напротив Леонарда и Шелдона. Сегодня ваше первое утро в новом доме. Вы выходите из квартиры и видите...",
                options: [
                    { 
                        text: "Осмотреться вокруг", 
                        nextScene: "lookAround",
                        playerReply: "Вы осматриваете коридор."
                    },
                    { 
                        text: "Пойти вниз по лестнице", 
                        nextScene: "goDownstairs",
                        playerReply: "Вы решили спуститься по лестнице."
                    },
                    { 
                        text: "Постучать в дверь напротив", 
                        nextScene: "knockDoor",
                        playerReply: "Вы стучите в дверь квартиры напротив."
                    }
                ]
            },
            
            // Основные сцены первого дня
            lookAround: {
                text: "Вы осматриваете коридор. Напротив вашей квартиры висит табличка 'Профессор Шелдон Купер, доктор философии' и 'Доктор Леонард Хофстедтер, доктор философии'. В конце коридора лифт и лестница.",
                options: [
                    { 
                        text: "Постучать в дверь напротив", 
                        nextScene: "knockDoor",
                        playerReply: "Вы решаете постучать в дверь напротив."
                    },
                    { 
                        text: "Пойти к лифту", 
                        nextScene: "elevator",
                        playerReply: "Вы направляетесь к лифту."
                    },
                    { 
                        text: "Вернуться в квартиру", 
                        nextScene: "returnHome",
                        playerReply: "Вы возвращаетесь в свою квартиру."
                    }
                ]
            },
            
            knockDoor: {
                text: '<span class="character sheldon">Шелдон</span> (открывает дверь): "О, новый сосед. Вы нарушили мой график. Я обычно не принимаю гостей в это время. Но раз уж вы здесь, я должен вас предупредить - по средам мы играем в "Halo" с 20:00 до 22:00, и шум может вас беспокоить. Хотя, согласно исследованию 2007 года..."',
                options: [
                    { 
                        text: "Извиниться и уйти", 
                        nextScene: "apologizeLeave",
                        playerReply: "Вы извиняетесь и уходите.",
                        effect: function() { gameState.scores.sheldon -= 5; }
                    },
                    { 
                        text: "Резко сказать: 'Какое расписание? Я просто хочу познакомиться!'", 
                        nextScene: "angrySheldon",
                        playerReply: "Вы грубо прерываете Шелдона.",
                        effect: function() { gameState.scores.sheldon -= 15; }
                    },
                    { 
                        text: "Вежливо представиться", 
                        nextScene: "friendlyTalk",
                        playerReply: "Вы вежливо представляетесь.",
                        effect: function() { 
                            gameState.scores.sheldon += 10;
                            gameState.flags.metCharacters = true;
                        }
                    }
                ]
            },
            
            friendlyTalk: {
                text: '<span class="character sheldon">Шелдон</span>: "А, вежливый человек! Это меняет дело. Леонард! У нас новый потенциальный друг!"<br><span class="character leonard">Леонард</span> (появляется в дверях): "Привет! Не обращай внимания на Шелдона, он всегда такой."',
                options: [
                    { 
                        text: "Предложить сходить в кафе", 
                        nextScene: "offerCoffee",
                        playerReply: "Вы предлагаете сходить в кафе.",
                        effect: function() { 
                            gameState.scores.leonard += 10;
                            gameState.scores.sheldon += 5;
                            gameState.flags.coffeeOffered = true;
                        }
                    },
                    { 
                        text: "Спросить про их исследования", 
                        nextScene: "askAboutResearch",
                        playerReply: "Вы спрашиваете об их научной работе.",
                        effect: function() { gameState.scores.sheldon += 15; }
                    },
                    { 
                        text: "Пригласить к себе на ужин", 
                        nextScene: "inviteForDinner",
                        playerReply: "Вы предлагаете приготовить ужин.",
                        effect: function() { 
                            gameState.scores.leonard += 5;
                            gameState.scores.sheldon -= 10;
                        }
                    }
                ]
            },
            
            // Ветка кафе
            offerCoffee: {
                text: '<span class="character leonard">Леонард</span>: "Кафе? Отличная идея! Мы как раз собирались..."<br><span class="character sheldon">Шелдон</span>: "Постой! Сначала нужно проверить расписание. Четверг... 10:37... Да, у нас есть 23 минуты до следующего обязательного мероприятия."<br><span class="character leonard">Леонард</span>: "Не слушай его. Пойдем в \'The Cheesecake Factory\'?"',
                options: [
                    { 
                        text: "Согласиться", 
                        nextScene: "goToCheesecake",
                        playerReply: "Вы соглашаетесь пойти в \'The Cheesecake Factory\'."
                    },
                    { 
                        text: "Предложить другое место", 
                        nextScene: "suggestOtherPlace",
                        playerReply: "Вы предлагаете пойти в другое кафе."
                    }
                ]
            },
            
            goToCheesecake: {
                text: '<span class="character leonard">Леонард</span>: "Отлично! Пенни как раз работает там официанткой. Познакомлю тебя!"<br><span class="character sheldon">Шелдон</span>: "Предупреждаю, я заказываю только чай Earl Grey, горячий, с молоком и сахаром в определенной пропорции."',
                options: [
                    { 
                        text: "Спросить про Пенни", 
                        nextScene: "askAboutPenny",
                        playerReply: "Вы спрашиваете, кто такая Пенни."
                    },
                    { 
                        text: "Пошутить про заказ Шелдона", 
                        nextScene: "jokeAboutOrder",
                        playerReply: "Вы шутите насчет специфичности заказа Шелдона.",
                        effect: function() { 
                            gameState.scores.sheldon -= 10;
                            gameState.scores.leonard += 5;
                        }
                    }
                ]
            },
            
            askAboutPenny: {
                text: '<span class="character leonard">Леонард</span> (немного смущаясь): "Эм... Пенни - это наша соседка снизу. Она... э... очень дружелюбная."<br><span class="character sheldon">Шелдон</span>: "Леонард испытывает романтические чувства к Пенни, несмотря на полное отсутствие интеллектуальной совместимости."',
                options: [
                    { 
                        text: "Поддержать Леонарда", 
                        nextScene: "supportLeonard",
                        playerReply: "Вы говорите, что чувства важнее интеллекта.",
                        effect: function() { 
                            gameState.scores.leonard += 15;
                            gameState.scores.sheldon -= 5;
                        }
                    },
                    { 
                        text: "Согласиться с Шелдоном", 
                        nextScene: "agreeWithSheldon",
                        playerReply: "Вы соглашаетесь, что интеллектуальная совместимость важна.",
                        effect: function() { 
                            gameState.scores.sheldon += 10;
                            gameState.scores.leonard -= 10;
                        }
                    }
                ]
            },
            
            supportLeonard: {
                text: '<span class="character leonard">Леонард</span>: "Спасибо! Наконец-то кто-то меня понимает!"<br><span class="character sheldon">Шелдон</span>: "Хм. Еще один представитель эмоционального мышления. Ну что ж, пойдемте в кафе, я продемонстрирую вам преимущества логики."',
                options: [
                    { 
                        text: "Пойти в кафе", 
                        nextScene: "cheesecakeArrival",
                        playerReply: "Вы отправляетесь в кафе."
                    }
                ]
            },
            
            cheesecakeArrival: {
                text: 'Вы приходите в "The Cheesecake Factory". <span class="character penny">Пенни</span> (подходит к столу): "Привет, парни! О, у вас новый друг?"<br><span class="character leonard">Леонард</span>: "Да, это наш новый сосед!"',
                options: [
                    { 
                        text: "Представиться Пенни", 
                        nextScene: "meetPenny",
                        playerReply: "Вы представляетесь Пенни.",
                        effect: function() { 
                            gameState.scores.penny += 10;
                            gameState.flags.metPenny = true;
                        }
                    },
                    { 
                        text: "Спросить меню", 
                        nextScene: "askMenu",
                        playerReply: "Вы просите меню."
                    }
                ]
            },
            
            meetPenny: {
                text: '<span class="character penny">Пенни</span>: "Приятно познакомиться! Ты тоже ученый, как эти два?"<br><span class="character sheldon">Шелдон</span>: "Пенни, вероятность того, что наш новый сосед имеет хоть какое-то отношение к науке, исходя из статистики..."',
                options: [
                    { 
                        text: "Сказать, что вы ученый", 
                        nextScene: "claimScientist",
                        playerReply: "Вы утверждаете, что тоже ученый.",
                        effect: function() { 
                            gameState.scores.sheldon += 5;
                            gameState.scores.penny -= 5;
                        }
                    },
                    { 
                        text: "Признаться, что нет", 
                        nextScene: "notScientist",
                        playerReply: "Вы признаетесь, что не ученый.",
                        effect: function() { 
                            gameState.scores.penny += 10;
                            gameState.scores.sheldon -= 10;
                        }
                    }
                ]
            },
            
            // Ветка научных исследований
            askAboutResearch: {
                text: '<span class="character sheldon">Шелдон</span>: "О! Вы проявляете интерес к науке? Я занимаюсь теорией струн, в частности, исследованием струнных вакуумов в контексте M-теории. Леонард же работает над экспериментальной проверкой..."<br><span class="character leonard">Леонард</span>: "Шелдон, думаю, нашему новому другу не нужна получасовая лекция."',
                options: [
                    { 
                        text: "Попросить объяснить проще", 
                        nextScene: "askSimplerExplanation",
                        playerReply: "Вы просите объяснить свои исследования проще.",
                        effect: function() { gameState.scores.sheldon -= 5; }
                    },
                    { 
                        text: "Сделать вид, что понял", 
                        nextScene: "pretendUnderstand",
                        playerReply: "Вы киваете, делая вид, что все поняли."
                    },
                    { 
                        text: "Задать умный вопрос", 
                        nextScene: "askSmartQuestion",
                        playerReply: "Вы задаете продуманный вопрос об их работе.",
                        effect: function() { 
                            gameState.scores.sheldon += 20;
                            gameState.scores.leonard += 10;
                        }
                    }
                ]
            },
            
            askSmartQuestion: {
                text: '<span class="character sheldon">Шелдон</span> (удивленно): "Восхитительно! Вы действительно разбираетесь в предмете! Леонард, нам нужно пригласить его на нашу следующую лекцию в университете."<br><span class="character leonard">Леонард</span>: "Может, сначала спросим, чем он занимается?"',
                options: [
                    { 
                        text: "Рассказать о своей работе", 
                        nextScene: "tellAboutYourself",
                        playerReply: "Вы рассказываете о своей профессии."
                    },
                    { 
                        text: "Пригласить их в комикшоп", 
                        nextScene: "inviteToComicStore",
                        playerReply: "Вы предлагаете сходить в магазин комиксов.",
                        effect: function() { 
                            gameState.scores.leonard += 10;
                            gameState.scores.sheldon += 5;
                            gameState.flags.comicBookStore = true;
                        }
                    }
                ]
            },
            
            // Ветка комикшопа
            inviteToComicStore: {
                text: '<span class="character leonard">Леонард</span>: "Ты читаешь комиксы? Отлично! Мы как раз собирались за новым выпуском \'Зеленого Фонаря\' сегодня!"<br><span class="character sheldon">Шелдон</span>: "Но только если мы успеем до 15:47, когда Стюарт начинает раскладывать новые поступления."',
                options: [
                    { 
                        text: "Согласиться пойти сейчас", 
                        nextScene: "goToComicStore",
                        playerReply: "Вы соглашаетесь пойти прямо сейчас."
                    },
                    { 
                        text: "Предложить встретиться позже", 
                        nextScene: "meetLaterForComics",
                        playerReply: "Вы предлагаете встретиться после обеда."
                    }
                ]
            },
            
            goToComicStore: {
                text: 'Вы приходите в "The Comic Center of Pasadena". <span class="character howard">Говард</span> и <span class="character raj">Раджеш</span> уже там.<br><span class="character howard">Говард</span>: "О, у нас новый член команды?"<br><span class="character raj">Раджеш</span> (шепотом): "Он... он мне нравится."',
                options: [
                    { 
                        text: "Познакомиться с Говардом и Раджешем", 
                        nextScene: "meetHowardRaj",
                        playerReply: "Вы представляетесь новым знакомым.",
                        effect: function() { 
                            gameState.scores.howard += 10;
                            gameState.scores.raj += 10;
                        }
                    },
                    { 
                        text: "Пойти посмотреть комиксы", 
                        nextScene: "browseComics",
                        playerReply: "Вы направляетесь к стеллажам с комиксами."
                    }
                ]
            },
            
            meetHowardRaj: {
                text: '<span class="character howard">Говард</span>: "Я Говард Воловиц, инженер. А это Раджеш Кутраппали, астрофизик. Он не может разговаривать с женщинами, если не выпьет."<br><span class="character raj">Раджеш</span> (писклявым голосом): "Говард!"',
                options: [
                    { 
                        text: "Пошутить про Раджеша", 
                        nextScene: "jokeAboutRaj",
                        playerReply: "Вы подшучиваете над проблемой Раджеша.",
                        effect: function() { 
                            gameState.scores.howard += 5;
                            gameState.scores.raj -= 10;
                        }
                    },
                    { 
                        text: "Спросить про работу Говарда", 
                        nextScene: "askAboutHowardsWork",
                        playerReply: "Вы спрашиваете о работе Говарда.",
                        effect: function() { 
                            gameState.scores.howard += 15;
                        }
                    }
                ]
            },
            
            // Ветка возвращения домой
            returnHome: {
                text: "Вы возвращаетесь в свою квартиру. Может быть, завтра будет лучший день для знакомства с соседями.",
                options: [
                    { 
                        text: "Закончить на сегодня", 
                        nextScene: "endDay",
                        playerReply: "Вы решаете отложить знакомство на завтра."
                    }
                ]
            },
            
            endDay: {
                text: "Вы проводите вечер, распаковывая коробки в своей новой квартире. Завтра новый день и новые возможности!",
                options: [
                    { 
                        text: "Начать следующий день", 
                        nextScene: "nextDay",
                        playerReply: "Вы ложитесь спать, чтобы начать новый день.",
                        effect: function() { 
                            gameState.day += 1;
                            updateStats();
                        }
                    }
                ]
            },
            
            nextDay: {
                text: "День " + gameState.day + ". Вы просыпаетесь от странного звука за стеной. Похоже, ваши соседи уже чем-то заняты.",
                options: [
                    { 
                        text: "Пойти познакомиться снова", 
                        nextScene: "knockDoorDay" + gameState.day,
                        playerReply: "Вы решаете снова попытаться познакомиться."
                    },
                    { 
                        text: "Займетесь своими делами", 
                        nextScene: "ownBusinessDay" + gameState.day,
                        playerReply: "Вы решаете заняться своими делами."
                    }
                ]
            },
            
            // Сцены второго дня
            knockDoorDay2: {
                text: 'Вы стучите в дверь. <span class="character sheldon">Шелдон</span> открывает: "А, это вы. Вчера вы проявили неожиданную для соседа адекватность. Может быть, вы заслуживаете ознакомления с официальными Правилами Соседства."',
                options: [
                    { 
                        text: "Внимательно изучить правила", 
                        nextScene: "readRules",
                        playerReply: "Вы соглашаетесь изучить правила.",
                        effect: function() { 
                            gameState.scores.sheldon += 15;
                            gameState.flags.sheldonsRules = true;
                        }
                    },
                    { 
                        text: "Отказаться", 
                        nextScene: "refuseRules",
                        playerReply: "Вы вежливо отказываетесь.",
                        effect: function() { 
                            gameState.scores.sheldon -= 10;
                            gameState.scores.leonard += 5;
                        }
                    }
                ]
            },
            
            readRules: {
                text: '<span class="character sheldon">Шелдон</span> (торжественно): "Вот 27-страничный документ, регулирующий все аспекты нашего соседского сосуществования. Особое внимание обратите на раздел \'Использование общего пространства\' и \'Шумовой режим во время трансляции \'The Big Bang Theory\'."',
                options: [
                    { 
                        text: "Подписать правила", 
                        nextScene: "signRules",
                        playerReply: "Вы подписываете документ.",
                        effect: function() { 
                            gameState.scores.sheldon += 20;
                            gameState.inventory.push("Правила соседства Шелдона");
                        }
                    },
                    { 
                        text: "Попросить время на изучение", 
                        nextScene: "askTimeToRead",
                        playerReply: "Вы просите время на изучение.",
                        effect: function() { 
                            gameState.scores.sheldon -= 5;
                        }
                    }
                ]
            },
            
            signRules: {
                text: '<span class="character sheldon">Шелдон</span> (радостно): "Превосходно! Теперь мы можем перейти к церемонии посвящения в Соседи. Первый этап - проверка знаний \'Звездного пути\'."<br><span class="character leonard">Леонард</span> (появляется): "Шелдон, может не будем мучить нового соседа?"',
                options: [
                    { 
                        text: "Согласиться на проверку", 
                        nextScene: "starTrekQuiz",
                        playerReply: "Вы соглашаетесь на викторину.",
                        effect: function() { 
                            gameState.scores.sheldon += 15;
                        }
                    },
                    { 
                        text: "Попросить более простое испытание", 
                        nextScene: "askEasierTest",
                        playerReply: "Вы просите что-то попроще.",
                        effect: function() { 
                            gameState.scores.sheldon -= 10;
                            gameState.scores.leonard += 5;
                        }
                    }
                ]
            },
            
            // Концовки
            starTrekQuiz: {
                text: '<span class="character sheldon">Шелдон</span>: "Вопрос первый: как звали вулканскую невесту Спока в оригинальной серии?"<br>Вы правильно отвечаете на все вопросы Шелдона.<br><span class="character sheldon">Шелдон</span> (со слезами на глазах): "Я нашел своего духовного брата! Леонард, мы должны принять его в нашу группу!"',
                options: [
                    { 
                        text: "СТАТЬ ПОЛНОПРАВНЫМ ЧЛЕНОМ КОМАНДЫ", 
                        nextScene: "goodEnding1",
                        playerReply: "Вы соглашаетесь присоединиться к компании."
                    }
                ]
            },
            
            goodEnding1: {
                text: '<span class="ending">ХОРОШАЯ КОНЦОВКА: НОВЫЙ ЧЛЕН КОМАНДЫ</span><br>Вы становитесь полноправным членом компании. Теперь ваша жизнь наполнена наукой, комиксами и странными приключениями с Шелдоном, Леонардом, Пенни, Говардом и Раджешем. Возможно, вы даже появитесь в одном из эпизодов "Теории большого взрыва"!',
                options: [
                    { 
                        text: "Начать заново", 
                        nextScene: "start",
                        playerReply: "",
                        effect: function() {
                            resetGame();
                        }
                    }
                ]
            },
            
            // Другие концовки
            refuseRules: {
                text: '<span class="character sheldon">Шелдон</span>: "Что ж, ваше право. Но тогда я вынужден ограничить наше общение формальными приветствиями в коридоре."<br><span class="ending">НЕЙТРАЛЬНАЯ КОНЦОВКА: ВЕЖЛИВЫЕ СОСЕДИ</span><br>Вы остаетесь вежливыми соседями, но так и не становитесь частью компании. Иногда вы видите их в коридоре и обмениваетесь парой слов, но не более того.',
                options: [
                    { 
                        text: "Начать заново", 
                        nextScene: "start",
                        playerReply: "",
                        effect: function() {
                            resetGame();
                        }
                    }
                ]
            },
            
            // Технические сцены
            ownBusinessDay2: {
                text: "Вы решаете заняться своими делами. Вечером, возвращаясь домой, вы встречаете в коридоре <span class='character penny'>Пенни</span>.<br><span class='character penny'>Пенни</span>: \"О, ты новый сосед! Как тебе квартира?\"",
                options: [
                    { 
                        text: "Познакомиться с Пенни", 
                        nextScene: "meetPennyHallway",
                        playerReply: "Вы представляетесь Пенни.",
                        effect: function() {
                            gameState.scores.penny += 10;
                            gameState.flags.metPenny = true;
                        }
                    },
                    { 
                        text: "Вежливо попрощаться", 
                        nextScene: "endDay",
                        playerReply: "Вы вежливо прощаетесь и идете к себе."
                    }
                ]
            },
            
            meetPennyHallway: {
                text: '<span class="character penny">Пенни</span>: "Рада познакомиться! О, эти парни сверху тебе уже рассказали про свои странные правила?"<br>Вы болтаете с Пенни около часа. Она рассказывает вам все сплетни про соседей.',
                options: [
                    { 
                        text: "Пригласить Пенни на кофе", 
                        nextScene: "invitePennyForCoffee",
                        playerReply: "Вы предлагаете сходить на кофе.",
                        effect: function() {
                            gameState.scores.penny += 15;
                        }
                    },
                    { 
                        text: "Попросить познакомить с другими", 
                        nextScene: "askToMeetOthers",
                        playerReply: "Вы просите познакомить с остальными."
                    }
                ]
            },
            
            // Сброс игры
            resetGame: function() {
                gameState = {
                    day: 1,
                    scores: {
                        sheldon: 50,
                        leonard: 50,
                        penny: 50,
                        howard: 50,
                        raj: 50
                    },
                    inventory: ["Ключи от квартиры", "Телефон"],
                    flags: {
                        metCharacters: false,
                        knowsAboutSpot: false,
                        coffeeOffered: false,
                        comicBookStore: false,
                        sheldonsRules: false,
                        metPenny: false
                    },
                    currentScene: "start"
                };
                updateStats();
                document.getElementById('dialogue-box').innerHTML = '';
                document.getElementById('options-container').innerHTML = '';
                showScene("start");
            }
        };

        // Функция для добавления текста в диалоговое окно
        function addDialogue(text) {
            const dialogueBox = document.getElementById('dialogue-box');
            const newDialogue = document.createElement('div');
            newDialogue.innerHTML = text;
            dialogueBox.appendChild(newDialogue);
            dialogueBox.scrollTop = dialogueBox.scrollHeight;
        }

        // Показать сцену
        function showScene(sceneId, playerReply) {
            const scene = typeof scenes[sceneId] === 'function' ? scenes[sceneId]() : scenes[sceneId];
            if (!scene) {
                console.error("Сцена не найдена:", sceneId);
                addDialogue("Извините, произошла ошибка. Попробуйте другой вариант.");
                return;
            }

            // Показываем ответ игрока, если он есть
            if (playerReply) {
                addDialogue('<span class="player">Вы:</span> ' + playerReply);
            }

            // Показываем текст сцены
            addDialogue(scene.text);

            // Очищаем и добавляем варианты ответов
            const optionsContainer = document.getElementById('options-container');
            optionsContainer.innerHTML = '';
            
            scene.options.forEach(option => {
                const button = document.createElement('button');
                button.textContent = option.text;
                button.addEventListener('click', () => {
                    // Применяем эффект, если он есть
                    if (option.effect) option.effect();
                    
                    // Обновляем статистику
                    updateStats();
                    
                    // Переходим к следующей сцене
                    showScene(option.nextScene, option.playerReply);
                });
                optionsContainer.appendChild(button);
            });
        }

        // Обновить статистику
        function updateStats() {
            document.getElementById('day').textContent = gameState.day;
            document.getElementById('sheldon-score').textContent = gameState.scores.sheldon;
            document.getElementById('leonard-score').textContent = gameState.scores.leonard;
            document.getElementById('penny-score').textContent = gameState.scores.penny;
            document.getElementById('howard-score').textContent = gameState.scores.howard;
            document.getElementById('raj-score').textContent = gameState.scores.raj;
            
            // Обновляем инвентарь
            const inventoryList = document.getElementById('inventory-list');
            inventoryList.innerHTML = '';
            gameState.inventory.forEach(item => {
                const li = document.createElement('li');
                li.textContent = item;
                inventoryList.appendChild(li);
            });
        }

        // Начать игру при загрузке страницы
        window.onload = function() {
            updateStats();
            showScene(gameState.currentScene);
        };
    </script>
</body>
</html>